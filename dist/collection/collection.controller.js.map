{"version":3,"sources":["../../src/collection/collection.controller.ts"],"sourcesContent":["import { Controller, Get, Post, Put, Delete, Body, Param, Req, ParseIntPipe, Query, DefaultValuePipe } from '@nestjs/common';\r\nimport { CollectionsService } from '@/collection/collection.service';\r\nimport { CollectionEntity } from '@/collection/entity/collection.entity';\r\nimport { Request } from 'express';\r\nimport { CreateCollectionDto } from '@/collection/dto/CreateCollection.dto';\r\nimport { UpdateCollectionDto } from '@/collection/dto/UpdateCollection.dto';\r\n\r\n@Controller('collection')\r\nexport class CollectionsController {\r\n  constructor(private readonly collectionsService: CollectionsService) {}\r\n\r\n  @Post()\r\n  async createCollection(\r\n    @Req () req: Request,\r\n    @Body() createCollectionDto:CreateCollectionDto\r\n  ){\r\n    const creatorPhone = (req.user as any).result.phone;\r\n    return await this.collectionsService.createCollection(createCollectionDto,creatorPhone)\r\n  }\r\n\r\n  @Put('/:id')\r\n  async updateCollection(\r\n    @Param(':collectionId',ParseIntPipe) collectionId: number,\r\n    @Req () req: Request,\r\n    @Body() updateCollectionDto: UpdateCollectionDto\r\n  ){\r\n    const currentOwnerPhone = (req.user as any).result.phone;\r\n    const currentUserRoles = (req.user as any).result.role;\r\n    return await this.collectionsService.updateCollection(\r\n      collectionId,\r\n      updateCollectionDto,\r\n      currentOwnerPhone,\r\n      currentUserRoles\r\n    )\r\n  }\r\n\r\n  @Get('all')\r\n  getAllCollections(\r\n    @Query('page', new DefaultValuePipe(1), ParseIntPipe) page: number,\r\n    @Query('limit', new DefaultValuePipe(10), ParseIntPipe) limit: number,\r\n    @Query('search') search?: string,\r\n    @Query('sortBy') sort?: string,\r\n    @Query('sortOrder') sortOrder?: 'ASC' | 'DESC',\r\n  ){\r\n    const query = { page, limit, search, sort, sortOrder };\r\n    return this.collectionsService.getAllCollections(query);\r\n  }\r\n\r\n}\r\n"],"names":["CollectionsController","createCollection","req","createCollectionDto","creatorPhone","user","result","phone","collectionsService","updateCollection","collectionId","updateCollectionDto","currentOwnerPhone","currentUserRoles","role","getAllCollections","page","limit","search","sort","sortOrder","query","constructor","DefaultValuePipe"],"mappings":";;;;+BAQaA;;;eAAAA;;;wBAR+F;mCACzE;yBAEX;qCACY;qCACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAG7B,IAAA,AAAMA,wBAAN,MAAMA;IAILC,iBACJ,AAAQC,GAAY,EACpB,AAAQC,mBAAuC;;eAHjD,oBAAA;YAKE,MAAMC,eAAe,AAACF,IAAIG,IAAI,CAASC,MAAM,CAACC,KAAK;YACnD,OAAO,MAAM,MAAKC,kBAAkB,CAACP,gBAAgB,CAACE,qBAAoBC;QAC5E;;IAGMK,iBACJ,AAAqCC,YAAoB,EACzD,AAAQR,GAAY,EACpB,AAAQS,mBAAwC;;eAJlD,oBAAA;YAME,MAAMC,oBAAoB,AAACV,IAAIG,IAAI,CAASC,MAAM,CAACC,KAAK;YACxD,MAAMM,mBAAmB,AAACX,IAAIG,IAAI,CAASC,MAAM,CAACQ,IAAI;YACtD,OAAO,MAAM,MAAKN,kBAAkB,CAACC,gBAAgB,CACnDC,cACAC,qBACAC,mBACAC;QAEJ;;IAGAE,kBACE,AAAsDC,IAAY,EAClE,AAAwDC,KAAa,EACrE,AAAiBC,MAAe,EAChC,AAAiBC,IAAa,EAC9B,AAAoBC,SAA0B,EAC/C;QACC,MAAMC,QAAQ;YAAEL;YAAMC;YAAOC;YAAQC;YAAMC;QAAU;QACrD,OAAO,IAAI,CAACZ,kBAAkB,CAACO,iBAAiB,CAACM;IACnD;IArCAC,YAAY,AAAiBd,kBAAsC,CAAE;aAAxCA,qBAAAA;IAAyC;AAuCxE;;;;;;;;;;;;;;;;;;;;;;;;;;;gDAVuBe,wBAAgB,CAAC;iDAChBA,wBAAgB,CAAC"}