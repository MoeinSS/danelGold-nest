{"version":3,"sources":["../src/main.ts"],"sourcesContent":["import { NestFactory } from '@nestjs/core';\r\nimport { AppModule } from './app.module';\r\nimport { ValidationPipe } from '@nestjs/common';\r\nimport { DocumentBuilder, SwaggerModule } from '@nestjs/swagger';\r\nimport passport from 'passport';\r\nimport { SwaggerHelper } from '@/common/utils/swagger.utils';\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create(AppModule, {});\r\n\r\n  app.enableCors({ origin: true, credentials: true });\r\n\r\n  app.useGlobalPipes(\r\n    new ValidationPipe({\r\n      whitelist: true,\r\n      forbidNonWhitelisted: true,\r\n      transform: true,\r\n    }),\r\n  );\r\n\r\n  app.use(passport.initialize());\r\n\r\n  const config = new DocumentBuilder()\r\n    .setTitle('Danel Gold')\r\n    .setDescription('project danel gold api')\r\n    .setVersion('1.0')\r\n    .addTag('DanelGold')\r\n    .addBearerAuth()\r\n    .build();\r\n\r\n  const document = SwaggerModule.createDocument(app, config);\r\n  SwaggerModule.setup('/api', app, document);\r\n\r\n  if (SwaggerHelper.prototype.setup) {\r\n    await new SwaggerHelper().setup(app);  \r\n  }\r\n\r\n  const port = process.env.PORT || 3000;  \r\n  await app.listen(port, '0.0.0.0');\r\n  console.log(`running on port ${port}...`);\r\n\r\n  function bytesToMB(bytes) {\r\n    return bytes / (1024 * 1024); \r\n  }\r\n\r\n  const memoryUsage = process.memoryUsage();\r\n\r\n  const rssMB = bytesToMB(memoryUsage.rss);\r\n  const heapTotalMB = bytesToMB(memoryUsage.heapTotal);\r\n  const heapUsedMB = bytesToMB(memoryUsage.heapUsed);\r\n  const externalMB = bytesToMB(memoryUsage.external);\r\n  const arrayBuffersMB = bytesToMB(memoryUsage.arrayBuffers);\r\n\r\n  const totalMemoryMB =\r\n    rssMB + heapTotalMB + heapUsedMB + externalMB + arrayBuffersMB;\r\n\r\n  console.log({\r\n    totalMemory: totalMemoryMB.toFixed(2) + ' MB',\r\n  });\r\n}\r\n\r\nbootstrap();\r\n\r\n"],"names":["bootstrap","app","NestFactory","create","AppModule","enableCors","origin","credentials","useGlobalPipes","ValidationPipe","whitelist","forbidNonWhitelisted","transform","use","passport","initialize","config","DocumentBuilder","setTitle","setDescription","setVersion","addTag","addBearerAuth","build","document","SwaggerModule","createDocument","setup","SwaggerHelper","prototype","port","process","env","PORT","listen","console","log","bytesToMB","bytes","memoryUsage","rssMB","rss","heapTotalMB","heapTotal","heapUsedMB","heapUsed","externalMB","external","arrayBuffersMB","arrayBuffers","totalMemoryMB","totalMemory","toFixed"],"mappings":";;;;sBAA4B;2BACF;wBACK;yBACgB;iEAC1B;8BACS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAEfA;WAAAA;;SAAAA;IAAAA,aAAf,oBAAA;QACE,MAAMC,MAAM,MAAMC,iBAAW,CAACC,MAAM,CAACC,oBAAS,EAAE,CAAC;QAEjDH,IAAII,UAAU,CAAC;YAAEC,QAAQ;YAAMC,aAAa;QAAK;QAEjDN,IAAIO,cAAc,CAChB,IAAIC,sBAAc,CAAC;YACjBC,WAAW;YACXC,sBAAsB;YACtBC,WAAW;QACb;QAGFX,IAAIY,GAAG,CAACC,iBAAQ,CAACC,UAAU;QAE3B,MAAMC,SAAS,IAAIC,wBAAe,GAC/BC,QAAQ,CAAC,cACTC,cAAc,CAAC,0BACfC,UAAU,CAAC,OACXC,MAAM,CAAC,aACPC,aAAa,GACbC,KAAK;QAER,MAAMC,WAAWC,sBAAa,CAACC,cAAc,CAACzB,KAAKe;QACnDS,sBAAa,CAACE,KAAK,CAAC,QAAQ1B,KAAKuB;QAEjC,IAAII,2BAAa,CAACC,SAAS,CAACF,KAAK,EAAE;YACjC,MAAM,IAAIC,2BAAa,GAAGD,KAAK,CAAC1B;QAClC;QAEA,MAAM6B,OAAOC,QAAQC,GAAG,CAACC,IAAI,IAAI;QACjC,MAAMhC,IAAIiC,MAAM,CAACJ,MAAM;QACvBK,QAAQC,GAAG,CAAC,CAAC,gBAAgB,EAAEN,KAAK,GAAG,CAAC;QAExC,SAASO,UAAUC,KAAK;YACtB,OAAOA,QAAS,CAAA,OAAO,IAAG;QAC5B;QAEA,MAAMC,cAAcR,QAAQQ,WAAW;QAEvC,MAAMC,QAAQH,UAAUE,YAAYE,GAAG;QACvC,MAAMC,cAAcL,UAAUE,YAAYI,SAAS;QACnD,MAAMC,aAAaP,UAAUE,YAAYM,QAAQ;QACjD,MAAMC,aAAaT,UAAUE,YAAYQ,QAAQ;QACjD,MAAMC,iBAAiBX,UAAUE,YAAYU,YAAY;QAEzD,MAAMC,gBACJV,QAAQE,cAAcE,aAAaE,aAAaE;QAElDb,QAAQC,GAAG,CAAC;YACVe,aAAaD,cAAcE,OAAO,CAAC,KAAK;QAC1C;IACF;WApDepD;;AAsDfA"}