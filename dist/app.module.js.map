{"version":3,"sources":["../src/app.module.ts"],"sourcesContent":["import { MiddlewareConsumer, Module, NestModule } from '@nestjs/common';\r\nimport { APP_FILTER, APP_GUARD, APP_INTERCEPTOR } from '@nestjs/core';\r\nimport { ConfigModule, ConfigService } from '@nestjs/config';\r\nimport { TypeOrmModule } from '@nestjs/typeorm';\r\nimport { ThrottlerModule } from '@nestjs/throttler';\r\nimport { ServeStaticModule } from '@nestjs/serve-static';\r\nimport typeormDataSource from './config/data-source';\r\nimport { join } from 'path';\r\nimport { AppController } from './app.controller';\r\nimport { AppService } from './app.service';\r\nimport { AuthModule } from './auth/auth.module';\r\nimport { OtpModule } from './auth/otp/otp.module';\r\nimport { JwtAuthGuard } from './auth/guards/jwt.guard';\r\nimport { RolesGuard } from './auth/guards/roles.guard';\r\nimport { JwtStrategy } from './auth/strategy/jwt.strategy';\r\nimport { TokenModule } from './auth/token/token.module';\r\nimport { UserModule } from './user/user.module';\r\nimport { SessionModule } from './session/session.module';\r\nimport { SubscribeModule } from './subscribe/subscribe.module';\r\nimport { UserDetailModule } from './user-detail/userDetail.module';\r\nimport { PaymentModule } from './payment/payment.module';\r\nimport { UploadModule } from './upload/upload.module';\r\nimport { WalletModule } from './wallet/wallet.module';\r\nimport { walletTransaction } from './wallet/entity/walletTransaction.entity';\r\nimport { LoggingInterceptor } from './common/utils/logger.interseptor';\r\nimport { AllExceptionsFilter } from './common/exeptionFilters/global.error';\r\nimport { UserAgentMiddleware } from './common/middleware/user-agent.middleware';\r\nimport { AuctionModule } from './auction/auction.module';\r\nimport { CollectionEntityModule } from './collection/collection.module';\r\nimport { NFTModule } from './nft/nft.module';\r\nimport { ForumModule } from './forum/forum.module';\r\nimport { SupportTicketModule } from './support-ticket/support-ticket.module';\r\nimport { TransactionModule } from './transaction/transaction.module';\r\nimport { UserService } from './user/user.service';\r\nimport { User } from './user/entity/user.entity';\r\nimport { Token } from './auth/token/entity/token.entity';\r\nimport { SmsService } from './services/sms.service';\r\nimport { IPFSService } from './services/IPFS.service';\r\nimport { PinataModule } from './pinta/pinta.module';\r\n\r\n\r\n@Module({\r\n  imports: [\r\n    ThrottlerModule.forRoot([\r\n      {\r\n        ttl: 60000,\r\n        limit: 50,\r\n      },\r\n    ]),\r\n    ServeStaticModule.forRoot({\r\n      rootPath: join(__dirname, '..', 'public'),\r\n      serveRoot: '/public',\r\n    }),\r\n    ConfigModule.forRoot({\r\n      envFilePath: '.develop.env',\r\n    }),\r\n    TypeOrmModule.forRootAsync({\r\n      imports: [ConfigModule],\r\n      inject: [ConfigService],\r\n\r\n      useFactory: (configService: ConfigService) => {\r\n        const synchronize = configService.get('NODE_ENV') === 'development';\r\n\r\n        console.log('synchronize ' + synchronize);\r\n        return {\r\n          ...typeormDataSource.options,\r\n          autoLoadEntities: true,\r\n        };\r\n      },\r\n    }),\r\n    TypeOrmModule.forFeature([\r\n      User,\r\n      Token\r\n    ]),\r\n    AuctionModule,\r\n    CollectionEntityModule,\r\n    NFTModule,\r\n    ForumModule,\r\n    SupportTicketModule,\r\n    WalletModule,\r\n    walletTransaction,\r\n    TransactionModule,\r\n    AuthModule,\r\n    UserModule,\r\n    UserDetailModule,\r\n    OtpModule,\r\n    SessionModule,\r\n    UploadModule,\r\n    SubscribeModule,\r\n    PaymentModule,\r\n    TokenModule,\r\n    PinataModule\r\n  ],\r\n  controllers: [AppController],\r\n  providers: [\r\n    AppService,\r\n    UserService,\r\n    IPFSService,\r\n    SmsService,\r\n    JwtStrategy,\r\n    {\r\n      provide: APP_GUARD,\r\n      useClass: JwtAuthGuard,\r\n    },\r\n    {\r\n      provide: APP_GUARD,\r\n      useClass: RolesGuard,\r\n    },\r\n    {\r\n      provide: APP_INTERCEPTOR,\r\n      useClass: LoggingInterceptor,\r\n    },\r\n    {\r\n      provide: APP_FILTER,\r\n      useClass: AllExceptionsFilter,\r\n    },\r\n  ],\r\n  exports:[IPFSService]\r\n})\r\nexport class AppModule implements NestModule {\r\n  configure(consumer: MiddlewareConsumer) {\r\n    consumer.apply(UserAgentMiddleware).forRoutes('*');\r\n  }\r\n}\r\n"],"names":["AppModule","configure","consumer","apply","UserAgentMiddleware","forRoutes","imports","ThrottlerModule","forRoot","ttl","limit","ServeStaticModule","rootPath","join","__dirname","serveRoot","ConfigModule","envFilePath","TypeOrmModule","forRootAsync","inject","ConfigService","useFactory","configService","synchronize","get","console","log","typeormDataSource","options","autoLoadEntities","forFeature","User","Token","AuctionModule","CollectionEntityModule","NFTModule","ForumModule","SupportTicketModule","WalletModule","walletTransaction","TransactionModule","AuthModule","UserModule","UserDetailModule","OtpModule","SessionModule","UploadModule","SubscribeModule","PaymentModule","TokenModule","PinataModule","controllers","AppController","providers","AppService","UserService","IPFSService","SmsService","JwtStrategy","provide","APP_GUARD","useClass","JwtAuthGuard","RolesGuard","APP_INTERCEPTOR","LoggingInterceptor","APP_FILTER","AllExceptionsFilter","exports"],"mappings":";;;;+BAuHaA;;;eAAAA;;;wBAvH0C;sBACA;wBACX;yBACd;2BACE;6BACE;mEACJ;sBACT;+BACS;4BACH;4BACA;2BACD;0BACG;4BACF;6BACC;6BACA;4BACD;+BACG;iCACE;kCACC;+BACH;8BACD;8BACA;yCACK;mCACC;6BACC;qCACA;+BACN;kCACS;2BACb;6BACE;qCACQ;mCACF;6BACN;4BACP;6BACC;4BACK;6BACC;6BACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiFtB,IAAA,AAAMA,YAAN,MAAMA;IACXC,UAAUC,QAA4B,EAAE;QACtCA,SAASC,KAAK,CAACC,wCAAmB,EAAEC,SAAS,CAAC;IAChD;AACF;;;QAjFEC,SAAS;YACPC,0BAAe,CAACC,OAAO,CAAC;gBACtB;oBACEC,KAAK;oBACLC,OAAO;gBACT;aACD;YACDC,8BAAiB,CAACH,OAAO,CAAC;gBACxBI,UAAUC,IAAAA,UAAI,EAACC,WAAW,MAAM;gBAChCC,WAAW;YACb;YACAC,oBAAY,CAACR,OAAO,CAAC;gBACnBS,aAAa;YACf;YACAC,sBAAa,CAACC,YAAY,CAAC;gBACzBb,SAAS;oBAACU,oBAAY;iBAAC;gBACvBI,QAAQ;oBAACC,qBAAa;iBAAC;gBAEvBC,YAAY,CAACC;oBACX,MAAMC,cAAcD,cAAcE,GAAG,CAAC,gBAAgB;oBAEtDC,QAAQC,GAAG,CAAC,iBAAiBH;oBAC7B,OAAO,wCACFI,mBAAiB,CAACC,OAAO;wBAC5BC,kBAAkB;;gBAEtB;YACF;YACAZ,sBAAa,CAACa,UAAU,CAAC;gBACvBC,gBAAI;gBACJC,kBAAK;aACN;YACDC,4BAAa;YACbC,wCAAsB;YACtBC,oBAAS;YACTC,wBAAW;YACXC,wCAAmB;YACnBC,0BAAY;YACZC,0CAAiB;YACjBC,oCAAiB;YACjBC,sBAAU;YACVC,sBAAU;YACVC,kCAAgB;YAChBC,oBAAS;YACTC,4BAAa;YACbC,0BAAY;YACZC,gCAAe;YACfC,4BAAa;YACbC,wBAAW;YACXC,yBAAY;SACb;QACDC,aAAa;YAACC,4BAAa;SAAC;QAC5BC,WAAW;YACTC,sBAAU;YACVC,wBAAW;YACXC,wBAAW;YACXC,sBAAU;YACVC,wBAAW;YACX;gBACEC,SAASC,eAAS;gBAClBC,UAAUC,sBAAY;YACxB;YACA;gBACEH,SAASC,eAAS;gBAClBC,UAAUE,sBAAU;YACtB;YACA;gBACEJ,SAASK,qBAAe;gBACxBH,UAAUI,qCAAkB;YAC9B;YACA;gBACEN,SAASO,gBAAU;gBACnBL,UAAUM,gCAAmB;YAC/B;SACD;QACDC,SAAQ;YAACZ,wBAAW;SAAC"}